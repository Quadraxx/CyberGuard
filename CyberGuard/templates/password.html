{% extends 'base.html' %}

{% block content %}
<div class="row">
    <div class="col-md-6 offset-md-3">
        <h2 class="mb-4 text-center">ðŸ”‘ Åžifre GÃ¼Ã§ AnalizÃ¶rÃ¼</h2>
        
        <div class="mb-3">
            <label>Åžifreni Gir (Merak etme, kaydetmiyoruz!)</label>
            <input type="text" id="passwordInput" class="form-control bg-dark text-white border-success mt-2" placeholder="Åžifreniz...">
        </div>

        <button onclick="checkPassword()" class="btn btn-hacker w-100">Analiz Et</button>

        <div id="resultArea" class="mt-4 d-none">
            <h4>GÃ¼venlik PuanÄ±: <span id="scoreVal">0</span>/100</h4>
            <div class="progress mb-3" style="height: 25px;">
                <div id="progressBar" class="progress-bar bg-danger" role="progressbar" style="width: 0%"></div>
            </div>
            <ul id="feedbackList" class="text-warning"></ul>
        </div>
    </div>
</div>

<script>
    function checkPassword() {
        let pwd = document.getElementById("passwordInput").value;

        fetch('/api/analyze-password', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({password: pwd})
        })
        .then(response => response.json())
        .then(data => {
            document.getElementById("resultArea").classList.remove("d-none");
            document.getElementById("scoreVal").innerText = data.score;
            
            let bar = document.getElementById("progressBar");
            bar.style.width = data.score + "%";
            
            // Renk deÄŸiÅŸtirme mantÄ±ÄŸÄ±
            if(data.score < 40) bar.className = "progress-bar bg-danger";
            else if(data.score < 80) bar.className = "progress-bar bg-warning";
            else bar.className = "progress-bar bg-success";

            let list = document.getElementById("feedbackList");
            list.innerHTML = "";
            data.feedback.forEach(msg => {
                list.innerHTML += `<li>${msg}</li>`;
            });
        });
    }
</script>
{% endblock %}